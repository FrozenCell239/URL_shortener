{% extends 'base.html.jinja' %}
{% block main %}
{% if files == [] %}
Vous n'avez aucun fichier pour le moment.
{% else %}
{% set toggle_message = "Êtes-vous sûr(e) de vouloir désactiver/réactiver le lien de téléchargement de ce fichier ?" %}
{% set delete_message = "Êtes-vous sûr(e) de vouloir supprimer ce fichier et son lien de téléchargement ? Cette action est irréversible !" %}
<table>
    <thead>
        <tr>
            <th>Raccourci</th>
            <th>Nombre de clics</th>
            <th>Statut</th>
            <th>Fichier attaché</th>
            <th>Créé le</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody>
        {% for file in files %}
        <tr class="tr">
            <td class="td-short"><a href='{{ domain_name ~ "dl/" ~ file.short }}'>{{ domain_name ~ "dl/" ~ file.short }}</a></td>
            <td class="td-clicks">{{ file.clicks }}</td>
            <td class="td-state">{{ "Actif" if file.state else "Désactivé" }}</td>
            <td class="td-original-filename">{{ file.attached_file_name }}</td>
            <td class="td-date">{{ files_dates[loop.index0].date ~ ", " ~ files_dates[loop.index0].time[:-3] ~ '.'}}</td>
            <td class="td-actions">
                <a href="#" onclick="openDialog('/u/files/{{ file.id }}/toggle', '{{ toggle_message }}')">
                    {{ "Désactiver" if file.state else "Réactiver"}}
                </a>
                <a
                    href="#"
                    onclick="openDialog('/u/files/{{ file.id }}/delete', '{{ delete_message }}')"
                    class="delete-action"
                >
                    Supprimer
                </a>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% include './_partials/_dialog.html.jinja' %}
{% endif %}
{% endblock %}